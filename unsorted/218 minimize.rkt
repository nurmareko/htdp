;; The first three lines of this file were inserted by DrRacket. They record metadata
;; about the language level of this file in a form that our tools can easily process.
#reader(lib "htdp-beginner-abbr-reader.ss" "lang")((modname |218 minimize|) (read-case-sensitive #t) (teachpacks ((lib "batch-io.rkt" "teachpack" "2htdp") (lib "image.rkt" "teachpack" "2htdp") (lib "universe.rkt" "teachpack" "2htdp") (lib "itunes.rkt" "teachpack" "2htdp"))) (htdp-settings #(#t constructor repeating-decimal #f #t none #f ((lib "batch-io.rkt" "teachpack" "2htdp") (lib "image.rkt" "teachpack" "2htdp") (lib "universe.rkt" "teachpack" "2htdp") (lib "itunes.rkt" "teachpack" "2htdp")) #f)))
(define L "left")(define R "right")(define U "up")(define D "down")(define TICK-RATE 0.1)(define SIZE 200)(define RADIUS 3)(define DIAMETER (* RADIUS 2))(define START-POSN (make-posn (/ SIZE 4) (/ SIZE 2)))(define HEAD (list START-POSN))(define WORM (circle RADIUS "solid" "red"))(define SCENE (empty-scene SIZE SIZE "black"))(define MIN (+ (- SIZE SIZE) (* RADIUS 2)))(define MAX (- SIZE (* RADIUS 2)))(define END-TEXT (text "ZHIEND" 12 "white"))(define TEXT-POSN (/ SIZE 2))(define-struct worm [ d tail])(define START(make-worm R HEAD))(define W9(make-worm R(list (make-posn 50 50) (make-posn 44 50)(make-posn 38 50) (make-posn 32 50)(make-posn 26 50) (make-posn 20 50)(make-posn 14 50) (make-posn 8 50)(make-posn 2 50))))(define DIRECTIONS(list L R U D))(define (worm-main s)(big-bang W9[to-draw render][on-tick move TICK-RATE][on-key director][stop-when hit-wall/body? end-scene]))(define (render s)(render-tail (worm-tail s)))(define (render-tail li)(cond[(empty? (rest li))(render-posn (first li) SCENE)][else (render-posn (first li)(render-tail (rest li)))]))(define (render-posn pos im)(place-image WORM(posn-x pos) (posn-y pos)im))(define (move s)(make-worm (worm-d s)(last-begone (add-head (worm-d s)(worm-tail s)))))(define (last-begone li)(cond[(empty? (rest li)) '()][else (cons (first li)(last-begone (rest li)))]))(define (add-head d li)(cons (head d (first li)) li))(define (head d pos)(cond [(string=? L d)(make-posn (- (posn-x pos) DIAMETER)(posn-y pos))][(string=? R d)(make-posn (+ (posn-x pos) DIAMETER)(posn-y pos))][(string=? U d)(make-posn (posn-x pos)(- (posn-y pos) DIAMETER))][(string=? D d)(make-posn (posn-x pos)(+ (posn-y pos) DIAMETER))]))(define (director s ke)(cond [(member? ke DIRECTIONS)(if (= 1 (length (worm-tail s)))(make-worm ke (worm-tail s))(if (equal?(head ke (first (worm-tail s)))(second (worm-tail s)))s (make-worm ke (worm-tail s))))][else s]))(define (hit-wall? pos)(if (or (<= (posn-x pos) MIN)(>= (posn-x pos) MAX)(<= (posn-y pos) MIN)(>= (posn-y pos) MAX))#true #false))(define (hit-body? s)(if (member? (first s) (rest s))#true #false))(define (hit-wall/body? s)(if (or (hit-wall? (first (worm-tail s)))(hit-body? (worm-tail s))) #true #false))(define (end-scene s)(place-image END-TEXT TEXT-POSN TEXT-POSN(render s)))(worm-main TICK-RATE)